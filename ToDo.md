# 25.04.17 (수)

### 구현 방식

1. 기존 API 사용 (카카오톡 공유 API)
- 카카오톡 보안 이슈로 동의하지 않은 사용자에게 메세지를 보낼 수 없음
- 친구한테 보내는 기능만 존재
  - 이 때 친구도 어플리케이션을 받아야 하고, 동의하는 절차가 필요
- 단톡방(오픈채팅 포함)에 자동 응답 기능이 아닌 메세지를 보내는 기능은 API로 구현이 불가능하다고 판단

2. 매크로 사용
- 구현은 쉬움 (pyautogui)
- 카톡 창이 계속 포커싱되어 있어야 함
  - 카톡 창이 움직이지 않는 경우에는 더 쉬움
- 하지만 계속 포커싱되어 있어야 하기 때문에 해당 컴퓨터는 이용할 수 없는 치명적인 단점이 존재

3. 프로그램 제작
- 카톡 창이 포커싱되어 있지 않아도 가능 (포커싱 되어 있어야 하는 것으로 추측됨)
  - 하지만 활성화가 되어 있어야 함
- 크몽에서 대부분의 카톡 메세지 자동전송 기능 판매자들이 프로그램으로 제작하여 배포중
  https://kmong.com/gig/469567
  https://kmong.com/gig/577650
- 메세지를 입력해서 전송하는 기능이 불안정함
  - 이를 해결하려면 시간이 좀 걸릴 것 같아 대안을 찾음 => **메신저봇R**

4. 메신저봇R 활용
- 카카오톡 부계정을 만들어 단톡방에 초대한 후에 일정 시간 간격으로 메세지 전송 가능
  - 하지만 부계정을 만드는 것이 문제
  - 부계정이 있다면 빠르게 테스트 가능
  - 부계정이 항상 접속해 있을 공기계도 필요
- 만약 공기계에서 화면 잠금 상태일 때도 정상적으로 작동하는지 확인 필요
- (추가) 텍스트나우 등 번호로 부계정 생성 시 오픈채팅 입장에 대략 일주일 정도의 이용승인 기간이 소요됨
  - 한국번호를 유료로 구매 시 이용승인 기간이 없어지는지 혹은 단축되는지 확인 필요
- 일단 이게 Gemin와 소통이 불가능함 => Tasker로 유턴
***
# 25. 04. 18

### 진행 상황 - 메신저봇R (부계정이 없어 디버그 모드에서만 테스트 진행)

1. 지정된 메세지 전송(상수)
   - 사용자가 먼저 메세지 입력 시 자동 응답 기능 확인
   - 일정한 텀을 두고 자동으로 메세지 입력 기능 확인

2. Gemini와 소통
   - 메신저봇R은 외부 HTTP 요청 기능을 아예 지원하지 않음
   - 따라서, Flask와 같은 중계 서버를 만들어야 함

3. Gemini API 초기화
   - 채팅방 입장 시 1회만 초기화
   - 그 다음부터는 계속 Gemini와 소통

4. 메신저봇R은 외부와 소통이 불가능하여 Gemini와 소통이 불가능 => "Tasker(유료 앱) 사용"
### 미팅 후
1. 카카오톡 공유 API로 구현 가능하다. 마음이 너무 급해서 내가 놓친 부분들이 많다.
   - main.py를 보면 flask를 이용해서 로컬 서버에 접근한다.
   - app key는 카카오 디벨로퍼스 내의 js 키
   - 공유까지 잘 되지만, 팀장님께서 말씀하신 것처럼 해당 링크를 누르면 접속이 되지 않음  
   (이 부분은 proxy url을 전달받아 적용할 예정)
   - UI보다는 기능 구현이 우선이기 때문에 UI는 뒤로 미뤄두고 다음 기능들부터 제작
2. 구현해야 할 기능들
   - 프로그램 화면 구성 => 일단은 기능 테스트가 가능하도록 최대한 간단하게 구성  
   <span style='color:blue'>예상: 04.18 </span> <span style='color:red'>완성: 04.18</span>
   - BabyNews(테스트용)을 크롤링하여 대략 2~3개씩 링크 삽입 - 크롤링부터 도전  
   <span style='color:blue'>예상: 04.18 </span> <span style='color:red'>완성: 04.21</span>
   - GPT와 소통하여 크롤링 한 뉴스 20자 내로 요약   
   <span style='color:blue'>예상: 04.19 </span> <span style='color:red'>완성: 04.21</span>
   - 요약한 글을 공유 링크의 제목으로 설정한 후 해당 링크에 접속이 가능한지 확인  
   <span style='color:blue'>예상: 04.20 </span> <span style='color:red'>완성: </span>  

**3. 목표 완성 기간: 4.21(월)**
***
# 25.04.21
### 진행 상황
1. 프로그램 UI
- 일단 기본적인 요소들만: 서버 시작, 작업 수행, 로그 표시
2. 크롤링
- BabyNews의 임신/출산 탭 접속
- 한 페이지에 뜨는 뉴스를 긁어와 날짜와 링크를 딕셔너리 형식으로 저장
  - 하루에 n개씩 띄운다고 가정할 때, 날짜를 기준으로 공유하는 방법도 있기 때문  
  ex) 21일에는 20일자 뉴스 n개, 22일에는 21일자 뉴스 n개 등
- 링크 접속 후 본문 추출
3. Gemini
- 추출한 본문을 15자 이내로 요약
  - 이는 공유하기 시 제목으로 사용할 예정

>**실행 순서**
>1. 크롤링
>2. 서버 시작 (크롤링한 정보를 share.html에 삽입)
>3. URL에 접속하여 공유하기 자동화

### 에러 상황
1. Gemini 할당량 초과 발생
=> 그래도 description이 잘 들어가는것까지 확인

### 해야할 일
1. 버튼 활성화 & 비활성화
2. 공유하기까지 자동화 (selenium) 
3. Proxy URL 설정

***
# 25. 04. 22
### 진행 상황
1. 크롤링, 서버(Flask), 본 작업 총 세개의 쓰레드를 생성하여 작업 수행
   - 크롤링 쓰레드는 크롤링 작업이 끝난 후 종료
   - 서버와 본 작업 쓰레드는 작업이 다 끝날 때까지 실행
2. 크롤링
   - BabyNews 기준
   - 한 페이지(총 20개) 중 3개를 추출
     (추후에 변경 가능 ex. 랜덤으로 추출, 날짜별로 추출 등)
3. Gemini
   - 기사 본문을 가져온 후 15자가 넘지 않게 요약
     (이 부분은 가끔 15자가 넘기도 하는 경우가 발생)
   - 할당량 초과 이슈로 API 키 새로 발급
4. shared.html
   - html 동적 생성으로 각 요소의 title, img url, description, url 전달


### 문제 해결
1. Gemini 할당량 초과
   - API 키를 새로 발급받는 것이 가장 효과적 (실제로 이렇게 해결)
2. 쓰레드 문제
   - 아직 발생하지 않았지만, 쓰레드 충돌 가능성도 염두해 두어야 함

### 해야할 일
1. <span style='color:red'>Title, Img URL 따서 html에 넘겨주기 - (완료)</span>
2. <span style='color:red'>버튼 활성화 및 비활성화 - (완료)</span>
3. 공유까지 자동화 (중간에 로그인은 수동으로)
   - 카카오 로그인 버튼에서 한번 정지  
   => 버튼 활성화 및 예외처리를 통해 로그인 인증이 완료되었는지 체크
   - 인증이 완료되어 버튼을 다시 누를 경우 작업 계속 수행
4. Proxy URL 설정
***
# 25. 04. 23
### 진행 상황
1. 공유까지 자동화 완성
   - 중간에 카카오 계정 인증하는 단계는 수동으로 전환

### 해야할 일
1. 카카오 아이디, 비밀번호, 채팅방 받아서 UI 최적화
2. <span style='color:red'>프록시 URL로 연결  
   (베이비뉴스 프록시가 막혀 있어 카카오 디벨로퍼에 직접 등록) - **완료**</span>
3. <span style='color:red'>이사님께 템플릿 링크 전송 - **완료**</span>
4. <span style='color:red'>서로 다른 템플릿 적용하여 테스트</span>
    - <span style='color:red'>여기서 서로 다른 템플릿이란, 아예 다른 기능을 하는 템플리 (ex. 지도, 텍스트, 캘린더 등)</span>
    - <span style='color:red'>현재 html에 대한 지식이 많이 부족하기 때문에 커스텀을 하려면 시간이 좀 걸릴듯 함 - **완료**</span>
5. Task 통합 - 서버시작 / (크롤링 + 작업 수행)
6. 인터벌: 4시간 단위 - 1일 총 6회(테스트 시에는 5분 단위)
    - 카테고리는 오피니언, 육아/휴직, 여성/교육
    - crawling.py에서 URL 배열 생성

### 아이디어
1. 채팅방 별로 링크를 다르게 한다면?
    - 채팅방 : 링크들
    - 이 형식으로 csv 파일을 받아 읽어오기
    - 그러면 링크마다 class_name을 추출해야 하는데...?

### 추가사항
1. 5번 및 6번 Task 통합 시 빠른 테스트를 위해 Gemini는 사용하지 않음
   - crawling.py 58-60
***
# 25. 04. 28
### 진행사항
1. 템플릿: 메세지 템플릿으로 글 나오고 링크 들어가기로 본문 보기
2. 사이트
    - 네이버 엔터의 최신뉴스
    - 한 페이지를 긁어서 AI에게 키즈와 관련된 기사를 긁어와달라고 요청
    - 그 후 프롬프트 수정을 통해 선별
    - 메세지 공유는 네시간에 한번씩 수행
3. AI는 GPT로 변경
***
# 25. 04. 29
### 진행사항
1. <span style='color:red'>네이버 뉴스 크롤링 - 완료</span>
2. <span style='color:red'>UI에 ID, PW, 채팅방 이름 추가 - 완료</span>
3. <span style='color:red'>텍스트 템플릿 적용하여 공유 - 완료</span>
4. <span style='color:red'>Gemini를 ChatGPT로 변경 - 완료</span>
5. <span style='color:red'>프롬프트에 예시 첨부 - 완료</span>
***

# 25. 05. 07
## To do
1. GUI 기반 프로그램을 CLI 기반 프로그램으로 변경  
   (python3 main.py로 동작하게끔)
2. Render.com 서버로 연동

## 논의 사항
1. 인자를 받아오는 경우는 (아이디, 비밀번호, 방 이름 등) 어떻게 처리할 건지?

***
# 25. 05. 08
## Todo
1. Render CLI를 이용해서 로그(print문) 확인
2. 완성하기

## 논의 사항 해결여부
1. 인자를 받아오는 경우 .env 파일에 저장해서 사용

***
# 25. 05. 12
1. 사내 서버에 접근 불가능 => 원격으로 해결
2. 뉴스 크롤링 시작
   - 네이버 - 뉴스 - IT/과학 - IT일반
   - 네이버 - 뉴스 - 사회 - 교육
   - 아이보스 - 뉴스
   - 구글 - 뉴스 - 비즈니스

***
# 25. 05. 14
1. 한번에 4개를 다 받아와서 vs 1개당 관련있는거 1개씩 뽑고 추리기
   - 한번에 보낼 수 있는 토큰이 제한되어 있어 후자로 선택

***
# 25. 05. 15
토큰이 제한되어 있기 때문에 본문이 아닌 제목을 전송
=> 사이트 1개당 20개를 추려서 gpt에 제공 (총 80개)
